# 修复手势返回TabBar异常显示问题

## 问题描述
用户反馈：通过手势返回上一页时，TabBar会出现在不应该显示的位置（如截图中红框所示）。

## 问题原因
在 `XZNavigationController.m` 的转场动画完成逻辑中，`animateDismissalWithContext` 方法会在手势返回动画完成后判断是否应该显示TabBar。但原有的判断逻辑不够严格，导致在非Tab根视图控制器的页面返回时也会错误地显示TabBar。

主要问题：
1. 原代码只是简单判断了导航控制器的视图数量是否为1
2. 没有准确判断返回的目标控制器是否真的是TabBarController的根视图控制器

## 修复方案

### 1. 修改 `animateDismissalWithContext` 方法中的TabBar显示逻辑
文件：`XZNavigationController.m` 第192-234行

修改内容：
- 增加更严格的判断逻辑，确保只有在返回到TabBarController的直接子控制器的根视图时才显示TabBar
- 遍历TabBarController的所有子控制器，准确判断目标视图控制器是否是某个Tab的根视图控制器

### 2. 修改延迟执行部分的TabBar处理逻辑
文件：`XZNavigationController.m` 第257-279行

修改内容：
- 在延迟执行的清理工作中，同样使用严格的判断逻辑
- 确保只有在应该显示TabBar的情况下才将其置于最前

### 3. 修改 `shouldHideTabBarForViewController` 方法
文件：`XZNavigationController.m` 第731-763行

修改内容：
- 不再简单地根据导航控制器视图数量判断
- 增加准确的TabBar根视图控制器判断逻辑
- 确保与转场动画完成时的判断逻辑一致

## 测试要点
1. 从首页进入二级页面，通过手势返回，TabBar不应该显示
2. 从二级页面返回到首页（Tab的根视图），TabBar应该正常显示
3. 切换不同的Tab，确保TabBar显示状态正确
4. 测试各种返回场景，确保TabBar只在应该显示的位置显示

## 风险评估
- 修改影响范围：仅影响导航控制器的转场动画和TabBar显示逻辑
- 风险等级：低
- 建议：充分测试各种页面返回场景