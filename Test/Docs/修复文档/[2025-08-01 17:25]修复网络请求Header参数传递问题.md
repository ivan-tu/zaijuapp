# [2025-08-01 17:25] 修复网络请求Header参数传递问题

## 问题描述
活动详情页面数据显示不完整，服务器返回"缺少必要参数"错误。

## 根本原因
JavaScript桥接中的网络请求没有正确传递Header参数，导致认证信息丢失。

## 修复内容

### 1. 扩展ClientJsonRequestManager支持Headers
**文件**: `ClientBase/BaseNet/ClientJsonRequestManager.h`
- 新增支持headers的GET和POST方法声明

**文件**: `ClientBase/BaseNet/ClientJsonRequestManager.m`  
- 实现`GET:parameters:headers:block:`方法
- 实现`POST:parameters:headers:block:`方法
- 添加详细的网络请求日志

### 2. 修复JSNetworkHandler参数传递
**文件**: `ClientBase/JSBridge/Handlers/JSNetworkHandler.m`
- 修改`handleRequest`方法，正确传递headers参数
- 添加请求参数的详细日志输出
- 使用新的支持headers的网络请求方法

## 修复关键点

1. **Header参数传递**
   ```objc
   // 修复前：headers获取但未使用
   NSDictionary *headers = dataDic[@"header"] ?: @{};
   [[ClientJsonRequestManager sharedClient] GET:url parameters:parameters block:...];
   
   // 修复后：正确传递headers
   [[ClientJsonRequestManager sharedClient] GET:url parameters:parameters headers:headers block:...];
   ```

2. **新增日志监控**
   ```objc
   NSLog(@"在局Claude Code[JavaScript桥接]+收到请求: URL=%@, Method=%@, Parameters=%@, Headers=%@", url, method, parameters, headers);
   NSLog(@"在局Claude Code[网络请求]+GET请求: %@, 参数: %@, Headers: %@", URLString, parameters, headers);
   ```

## 预期效果
- 认证信息正确传递到服务器
- 活动详情数据完整显示
- 用户参与信息和评论正常加载
- 解决"缺少必要参数"错误

## 测试建议
1. 重新测试活动详情页面加载
2. 检查网络请求日志确认headers正确传递
3. 验证数据显示完整性

## 技术说明
此修复保持了向后兼容性，原有的不带headers的方法仍然可用，新增的方法只是扩展功能。