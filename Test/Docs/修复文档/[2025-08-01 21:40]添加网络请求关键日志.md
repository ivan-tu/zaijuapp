# 添加网络请求关键日志

## 修改时间
2025-08-01 21:40

## 问题描述
接口偶尔无法正常调用，需要添加关键日志来协助测试定位问题。

## 修改文件
- `XZVientiane/ClientBase/BaseNet/ClientJsonRequestManager.m`

## 修改内容

### 1. 网络状态检查日志
- 在 `cachedDataWithKey:block:` 方法中添加了网络状态检查日志
- 记录当前网络状态和缓存使用情况

### 2. GET请求日志增强
- 添加请求URL、参数、缓存key的日志
- 添加Token检查前后的baseURL日志
- 添加响应状态码、响应数据的详细日志
- 增强错误日志，包含HTTP状态码、错误域、错误码、错误描述和详细错误信息

### 3. POST请求日志增强（带headers版本）
- 添加请求URL、参数、headers的日志
- 添加完整URL拼接日志
- 添加响应状态码、响应数据的详细日志
- 增强错误日志，包含HTTP状态码、错误域、错误码、错误描述和详细错误信息

### 4. POST请求日志增强（无headers版本）
- 添加请求URL、参数的日志
- 添加Token检查前后的baseURL日志
- 添加响应状态码、响应数据的详细日志
- 增强错误日志，包含HTTP状态码、错误域、错误码、错误描述和详细错误信息

### 5. POSTRPC请求日志增强
- 添加原始参数和实际POST参数的日志
- 添加JSON序列化错误捕获和日志
- 添加响应状态码、响应数据的详细日志
- 增强错误日志，包含HTTP状态码、错误域、错误码、错误描述和详细错误信息

### 6. Token刷新日志增强
- 添加当前Token和过期时间的日志
- 添加Token刷新请求URL日志
- 添加刷新响应状态码日志
- 添加刷新失败错误日志
- 添加JSON解析错误日志
- 添加刷新成功后的新Token和过期时间日志
- 添加access_token缺失的错误日志

## 日志格式说明
所有添加的日志都遵循规范格式：`在局Claude Code[功能模块]+日志内容`

## 测试建议
1. 运行应用并触发网络请求
2. 在Xcode控制台查看日志输出
3. 重点关注以下情况：
   - 网络状态检查结果
   - BaseURL是否正确
   - Token是否正常获取和更新
   - 请求URL拼接是否正确
   - 响应状态码和数据
   - 具体的错误信息

通过这些日志，可以快速定位接口调用失败的具体原因。