# 修复接口请求方法错误问题

## 修改时间
2025-08-02 01:03

## 问题描述
虽然GET请求的参数已经正确添加到URL中，但某些接口仍然返回"缺少必要参数"。通过用户提供的浏览器开发者工具截图发现，这些接口实际上需要使用POST请求，而不是GET请求。

受影响的接口：
- `/activityapi/getActivityDetail` - 获取活动详情
- `/activityapi/getActivityUser` - 获取活动用户列表
- `/admin/getArticleInfo` - 获取文章信息
- `/activityapi/getActivityComments` - 获取活动评论（这个接口之前能正常工作，可能是服务器对GET/POST都支持）

## 问题分析
1. 前端JavaScript没有传递method参数
2. Native代码默认使用GET请求
3. 但服务器端这些接口只接受POST请求
4. GET请求虽然URL中包含了参数，但服务器不从URL读取参数

## 修复方案
在`JSNetworkHandler.m`中添加了请求方法判断逻辑：

```objc
// 在局Claude Code修复：某些接口必须使用POST请求
if (!method || method.length == 0) {
    // 根据URL判断应该使用的请求方法
    if ([url containsString:@"getActivityDetail"] ||
        [url containsString:@"getActivityUser"] ||
        [url containsString:@"getActivityComments"] ||
        [url containsString:@"getArticleInfo"]) {
        method = @"POST";
        NSLog(@"在局Claude Code[请求方法修正]+接口 %@ 默认使用POST请求", url);
    } else {
        method = @"GET";
    }
}
```

## 修改的文件
- `XZVientiane/ClientBase/JSBridge/Handlers/JSNetworkHandler.m`

## 测试要点
1. 重新编译运行
2. 进入活动详情页
3. 检查内页数据是否正常显示
4. 进入文章详情页（如用户协议）
5. 检查文章内容是否正常显示

## 预期结果
- 接口使用正确的POST方法请求
- 服务器正常返回数据
- 内页数据能够正常显示

## 注意事项
1. 这是一个临时修复方案，理想情况下前端应该明确指定请求方法
2. 如果有其他接口也需要POST请求，可以在判断条件中添加
3. 评论接口可能对GET/POST都支持，所以之前能正常工作