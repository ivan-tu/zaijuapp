# 在局App项目依赖说明文档

## 文档说明
本文档详细记录了在局App项目中使用的所有第三方依赖库，包括其作用、使用场景、版本要求等信息。此文档主要用于项目升级到Swift时的参考。

## 目录

1. [UI布局与显示](#ui布局与显示)
   - [Masonry](#masonry)
   - [MJRefresh](#mjrefresh)
   - [SDWebImage](#sdwebimage)

2. [网络请求与数据处理](#网络请求与数据处理)
   - [AFNetworking](#afnetworking)
   - [JSONModel](#jsonmodel)
   - [Qiniu](#qiniu)

3. [安全与工具](#安全与工具)
   - [GTMBase64](#gtmbase64)
   - [SAMKeychain](#samkeychain)

4. [第三方SDK集成](#第三方sdk集成)
   - [友盟SDK套件](#友盟sdk套件)
   - [支付宝SDK](#支付宝sdk)
   - [高德地图SDK](#高德地图sdk)

5. [手动集成的库](#手动集成的库)
   - [UI组件库](#ui组件库)
     - [MBProgressHUD](#mbprogresshud)
     - [CWStatusBarNotification](#cwstatusbarnotification)
     - [SVStatusHUD](#svstatushud)
     - [DHGuidePageHUD](#dhguidepagehud)
   - [功能组件库](#功能组件库)
     - [TZImagePickerController](#tzimagepickercontroller)
     - [LBPhotoBrowser](#lbphotobrowser)
     - [JFCityViewController](#jfcityviewcontroller)
     - [SCIndexView](#scindexview)
     - [AddressFormMap](#addressformmap)
   - [社交平台SDK](#社交平台sdk-1)
   - [WKWebViewJavascriptBridge](#wkwebviewjavascriptbridge)
   - [微信SDK](#微信sdk)

6. [迁移到Swift的注意事项](#迁移到swift的注意事项)

---

## UI布局与显示

### Masonry
**版本**: 1.1.0  
**作用**: iOS自动布局框架，使用链式语法简化NSLayoutConstraint的使用

**主要功能**:
- 提供简洁的链式语法进行布局约束
- 支持批量更新约束
- 自动激活约束，无需手动设置

**在项目中的使用**:
- 所有界面布局都使用Masonry进行约束设置
- WebView布局：`CFJClientH5Controller.m`、`XZWKWebViewBaseController.m`
- 自定义视图布局：`XZNavBar.m`（导航栏）、`MOFSDatePicker.m`（日期选择器）
- 列表cell布局：`AdressHistoryCell.m`、`LocationCell.m`
- 城市选择器：`JFCityHeaderView.m`、`JFButton.m`

**Swift迁移建议**:
- 可以使用SnapKit（Masonry的Swift版本）
- 或使用原生的NSLayoutAnchor API
- 考虑SwiftUI的声明式布局（如果最低版本支持）

### MJRefresh
**版本**: 3.7.9  
**作用**: 下拉刷新和上拉加载更多控件

**主要功能**:
- 支持UITableView、UICollectionView、UIScrollView、WKWebView
- 多种刷新样式和自定义动画
- 支持自动刷新和手动刷新

**在项目中的使用**:
- WebView下拉刷新：`XZWKWebViewBaseController.m`
- JS桥接刷新控制：`JSUIHandler.m`
- 主要用于H5页面的下拉刷新功能

**Swift迁移建议**:
- MJRefresh有Swift版本，可直接使用
- 或考虑使用原生的UIRefreshControl（功能较简单）

### SDWebImage
**版本**: ~> 5.0.6  
**作用**: 异步图片下载和缓存管理框架

**主要功能**:
- 异步下载和缓存管理
- 内存和磁盘缓存
- 支持多种图片格式（包括WebP、GIF）
- 渐进式图片加载

**在项目中的使用**:
- 图片分享功能：`CFJClientH5Controller.m`
- TabBar图标加载：`XZTabBarController.m`
- 图片浏览器：`LBPhotoBrowser`相关类
- 网络图片显示和缓存

**Swift迁移建议**:
- SDWebImage支持Swift，可通过SPM或CocoaPods集成
- 考虑使用Kingfisher（纯Swift实现的图片加载框架）

---

## 网络请求与数据处理

### AFNetworking
**版本**: 4.0.1  
**作用**: iOS和macOS的网络请求框架

**主要功能**:
- HTTP/HTTPS请求（GET、POST、PUT、DELETE等）
- 文件上传下载
- 网络状态监控
- 请求和响应序列化

**在项目中的使用**:
- 网络状态监控：`AppDelegate.m`中的`AFNetworkReachabilityManager`
- API请求封装：`ClientJsonRequestManager.h`
- 业务请求：`ManageCenter.m`
- JS桥接网络功能：`JSMiscHandler.m`
- 文件上传：`CFJClientH5Controller.m`

**Swift迁移建议**:
- 使用Alamofire（AFNetworking的Swift版本）
- 或使用原生的URLSession（iOS 7+）
- 考虑使用Moya进行网络层抽象

### JSONModel
**版本**: 1.8.0  
**作用**: JSON与Model对象的自动转换

**主要功能**:
- JSON自动映射到Model属性
- 数据验证
- 嵌套对象支持
- 自定义转换器

**在项目中的使用**:
- 基础模型类：`XZJsonModel.h`
- 实际使用较少，可能后期被其他方案替代

**Swift迁移建议**:
- 使用Swift的Codable协议（推荐）
- 或使用SwiftyJSON、ObjectMapper等第三方库

### Qiniu
**版本**: 8.9.0  
**作用**: 七牛云存储SDK

**主要功能**:
- 文件上传到七牛云
- 断点续传
- 上传进度回调

**在项目中的使用**:
- 图片、视频等文件上传功能
- 配合七牛云存储服务使用

**Swift迁移建议**:
- 七牛官方提供Swift SDK
- 可直接使用官方Swift版本

---

## 安全与工具

### GTMBase64
**版本**: 1.0.1  
**作用**: Base64编解码工具

**主要功能**:
- Base64编码和解码
- 支持URL安全的Base64

**在项目中的使用**:
- 数据加密传输
- 图片Base64转换

**Swift迁移建议**:
- Swift原生支持Base64（Data的base64EncodedString方法）
- 无需额外依赖

### SAMKeychain
**版本**: 1.5.3  
**作用**: iOS钥匙串访问封装

**主要功能**:
- 安全存储敏感信息（密码、token等）
- 简化Keychain API使用
- 支持访问控制

**在项目中的使用**:
- 存储用户凭证
- 保存敏感配置信息

**Swift迁移建议**:
- 使用KeychainAccess（Swift版本）
- 或使用SwiftKeychainWrapper

---

## 第三方SDK集成

### 友盟SDK套件

#### UMCCommon
**作用**: 友盟基础库，提供基础功能支持

**版本信息**:
- UMCCommon: 7.3.7/7.5.3
- UMShare: 6.10.15
- UMPush: 4.1.3
- UMDevice: 3.4.0
- UMAPM: 2.0.4

**在项目中的配置**:
```objc
[UMConfigure initWithAppkey:@"5db314c23fc195be40000ac6" channel:@"App Store"];
```

#### UMShare
**作用**: 社交分享功能

**集成的平台**:
- 微信分享（使用精简版，不含支付）
- QQ分享
- 微博分享
- 支付宝分享
- 钉钉分享

**使用子规格说明**:
```ruby
pod 'UMShare/Core'                    # 核心功能
pod 'UMShare/UI'                      # UI组件
pod 'UMShare/Social/ReducedWeChat'   # 精简版微信
pod 'UMShare/Social/ReducedQQ'       # 精简版QQ
pod 'UMShare/Social/ReducedSina'     # 精简版微博
pod 'UMShare/Social/AlipayShare'     # 支付宝分享
pod 'UMShare/Social/DingDing'        # 钉钉分享
```

#### UMPush
**作用**: 推送通知服务

**主要功能**:
- 远程推送
- 本地通知
- 推送统计

**Swift迁移建议**:
- 友盟SDK支持Swift项目
- 需要创建桥接头文件
- 考虑使用原生的UserNotifications框架配合第三方推送服务

### 支付宝SDK
**版本**: AlipaySDK-iOS 15.8.30  
**作用**: 支付宝支付功能

**主要功能**:
- 支付宝App支付
- 支付结果回调

**在项目中的使用**:
- 支付功能：`JSPaymentHandler.m`
- 支付回调：`AppDelegate.m`

**Swift迁移建议**:
- 支付宝SDK支持Swift
- 需要桥接头文件
- 注意URL Scheme配置

### 高德地图SDK
**版本信息**:
- AMap3DMap: 10.0.1000（实际安装版本）
- AMapFoundation: 1.8.2
- AMapSearch: 9.7.4
- AMapLocation: 2.10.0

**Podfile配置**:
```ruby
pod 'AMap3DMap', '~> 10.0.600'     # 特定版本解决Xcode 16兼容性
pod 'AMapFoundation'                # 基础SDK
pod 'AMapSearch'                    # 搜索功能
pod 'AMapLocation'                  # 定位功能
```

**作用**: 地图显示、定位、搜索功能

**主要功能**:
- 地图显示和交互
- GPS定位
- 逆地理编码
- POI搜索

**在项目中的使用**:
- 地图初始化：`AppDelegate.m`
- 定位功能：`JSLocationHandler.m`
- 地图选址：`AddressFromMapViewController.m`
- 配合H5页面的地图功能

**Swift迁移建议**:
- 高德SDK支持Swift
- 需要配置桥接头文件
- 注意权限配置（定位权限）

---

## 手动集成的库

### UI组件库

#### MBProgressHUD
**位置**: `XZVientiane/ThirdParty/MBProgressHUD/`  
**作用**: iOS加载提示框

**主要功能**:
- 显示加载动画
- 进度条显示
- 成功/失败提示
- 自定义视图

**Swift迁移建议**:
- 使用SVProgressHUD（有Swift支持）
- 或使用SwiftUI的ProgressView

#### CWStatusBarNotification
**位置**: `XZVientiane/ThirdParty/CWStatusBarNotification/`  
**作用**: 状态栏通知显示

**主要功能**:
- 在状态栏显示通知消息
- 支持多种动画效果
- 自定义样式

**Swift迁移建议**:
- 使用SwiftMessages
- 或自行实现

#### SVStatusHUD
**位置**: `XZVientiane/ThirdParty/SVStatusHUD/`  
**作用**: 轻量级状态提示框

**主要功能**:
- 简单的成功/失败/加载提示
- 自动消失

**Swift迁移建议**:
- 使用Toast-Swift
- 或使用系统的UIAlertController

#### DHGuidePageHUD
**位置**: `XZVientiane/ThirdParty/DHGuidePageHUD/`  
**作用**: 新手引导页

**主要功能**:
- 首次启动引导
- 支持GIF动画
- 跳过按钮

**Swift迁移建议**:
- 使用Instructions（Swift引导库）
- 或自定义实现

### 功能组件库

#### TZImagePickerController
**位置**: `XZVientiane/ThirdParty/TZImagePickerController/`  
**作用**: 多功能图片选择器

**主要功能**:
- 多选图片/视频
- 拍照功能
- 图片裁剪
- 预览功能
- 支持GIF和视频

**在项目中的使用**:
- 用户头像选择
- 动态发布图片选择
- 各种需要选择图片的场景

**Swift迁移建议**:
- 使用YPImagePicker（纯Swift）
- 或使用PhotosUI（iOS 14+）

#### LBPhotoBrowser
**位置**: `XZVientiane/ThirdParty/LBPhotoBrowser/`  
**作用**: 图片浏览器

**主要功能**:
- 图片缩放
- 手势操作
- 图片保存
- 加载动画

**Swift迁移建议**:
- 使用Lightbox
- 或使用JXPhotoBrowser

#### JFCityViewController
**位置**: `XZVientiane/ThirdParty/JFCityViewController/`  
**作用**: 城市选择器

**主要功能**:
- 城市列表展示
- 首字母索引
- 搜索功能
- 定位当前城市
- 热门城市

**包含文件**:
- 城市数据：`cityList.json`
- 定位功能：`JFLocation.h/m`
- 数据管理：`JFAreaDataManager.h/m`

**Swift迁移建议**:
- 自行实现（相对简单）
- 参考开源的Swift城市选择器

#### SCIndexView
**位置**: `XZVientiane/ThirdParty/SCIndexView/`  
**作用**: TableView索引视图

**主要功能**:
- 自定义索引样式
- 支持UITableView扩展
- 灵活配置

**Swift迁移建议**:
- 使用原生的sectionIndexTitles
- 或自定义实现

#### AddressFormMap
**位置**: `XZVientiane/ThirdParty/AddressFormMap/`  
**作用**: 地图选址组件

**主要功能**:
- 地图显示
- 地址搜索
- 历史地址
- POI选择

**Swift迁移建议**:
- 基于高德地图SDK重新实现
- 使用Swift编写更简洁的接口

### 社交平台SDK

#### SocialLibraries
**位置**: `XZVientiane/ThirdParty/SocialLibraries/`  
**作用**: 各社交平台SDK的封装

**包含的SDK**:
1. **钉钉SDK** (`DingDing/`)
   - DTShareKit.framework
   - 钉钉分享功能

2. **QQ SDK** (`QQ/`)
   - 精简版QQ SDK
   - QQ登录和分享

3. **新浪微博SDK** (`Sina/`)
   - 微博分享功能

4. **微信SDK** (`WeChat/`)
   - 版本：OpenSDK1.8.7.1
   - 包含登录、支付、分享功能

**Swift迁移建议**:
- 继续使用官方SDK
- 通过桥接头文件使用
- 注意更新到最新版本

### WKWebViewJavascriptBridge
**位置**: `XZVientiane/ThirdParty/WKWebViewJavascriptBridge/`  
**作用**: WebView与JavaScript的双向通信桥接

**不使用CocoaPods的原因**:
- 官方版本包含UIWebView会被Apple拒绝
- 需要自定义修改以适配项目需求

**主要功能**:
- Native调用JS方法
- JS调用Native方法
- 消息队列管理
- 回调处理

**在项目中的使用**:
- 核心桥接对象：`xzBridge`
- 所有JS与Native的交互都通过此桥接实现
- 已重构为模块化的Handler架构

**Swift迁移建议**:
- 可以用Swift重写（推荐）
- 或使用WKScriptMessageHandler（原生方案）
- 考虑使用更现代的方案如JavaScriptCore

### 微信SDK
**版本**: 手动集成  
**AppID**: wx10a321f7fbdd6023  
**作用**: 微信登录、支付、分享

**不使用CocoaPods的原因**:
- 与友盟分享SDK中的精简版微信冲突
- 需要完整的支付功能

**主要功能**:
- 微信登录
- 微信支付
- 微信分享（朋友、朋友圈）

**Swift迁移建议**:
- 微信SDK支持Swift
- 需要桥接头文件
- 注意Universal Links配置

---

## 迁移到Swift的注意事项

### 1. 依赖管理
- 优先使用Swift Package Manager (SPM)
- 部分SDK可能仍需要CocoaPods
- 考虑逐步替换为纯Swift实现的库

### 2. 桥接处理
- 需要创建Bridging Header文件
- Objective-C的SDK需要通过桥接使用
- 注意命名空间的变化

### 3. 替代方案建议

| Objective-C库 | Swift替代方案 |
|-------------|--------------|
| Masonry | SnapKit 或 原生Layout |
| AFNetworking | Alamofire 或 URLSession |
| JSONModel | Codable协议 |
| SDWebImage | Kingfisher |
| MJRefresh | 继续使用或原生实现 |
| GTMBase64 | Swift原生支持 |
| SAMKeychain | KeychainAccess |

### 4. 架构考虑
- WebView桥接可考虑使用WKScriptMessageHandler
- 考虑使用Combine框架处理异步操作
- 利用Swift的强类型特性重构数据模型

### 5. 性能优化
- Swift编译优化设置
- 减少Objective-C与Swift的频繁交互
- 使用Swift的值类型优化内存使用

### 6. 第三方SDK注意事项
- 确认SDK是否支持Swift或有Swift版本
- 检查最低iOS版本要求
- 注意SDK的更新和维护状态

---

## 依赖统计

### CocoaPods依赖（14个）
- UI相关：Masonry、MJRefresh、SDWebImage
- 网络相关：AFNetworking、Qiniu
- 数据处理：JSONModel、GTMBase64、SAMKeychain
- 友盟SDK：UMCCommon、UMShare（含多个子规格）、UMPush
- 支付：AlipaySDK-iOS
- 地图：AMap3DMap、AMapFoundation、AMapSearch、AMapLocation

### 手动集成依赖（15个+）
- UI组件：MBProgressHUD、CWStatusBarNotification、SVStatusHUD、DHGuidePageHUD
- 功能组件：TZImagePickerController、LBPhotoBrowser、JFCityViewController、SCIndexView、AddressFormMap
- JavaScript桥接：WKWebViewJavascriptBridge
- 社交SDK：微信SDK、钉钉SDK、QQ SDK、新浪微博SDK
- 友盟分享框架：UMShare.framework

## 总结

项目当前共使用约30个第三方依赖，涵盖了UI、网络、数据处理、第三方服务等多个方面。其中：
- **CocoaPods管理**：14个依赖
- **手动集成**：15个以上依赖（包括多个社交平台SDK）
- **核心依赖**：AFNetworking（网络）、Masonry（布局）、WebViewJavascriptBridge（JS桥接）、各平台SDK

在迁移到Swift时，建议：

1. **分类迁移**：
   - 优先迁移有成熟Swift版本的库（如Masonry→SnapKit）
   - 保留必要的Objective-C SDK（支付、地图、社交平台）
   - 逐步替换手动集成的UI组件

2. **技术选型**：
   - 优先使用Swift Package Manager
   - 考虑使用SwiftUI替代部分UI组件
   - 利用Swift原生功能减少依赖（如Codable替代JSONModel）

3. **迁移策略**：
   - 制定分阶段迁移计划
   - 先迁移工具类库，再迁移UI组件，最后处理第三方SDK
   - 保持功能的向后兼容性
   - 充分测试每个阶段的迁移结果

4. **注意事项**：
   - 部分库可能需要继续使用Objective-C版本
   - 注意第三方SDK的Swift支持情况
   - 考虑iOS最低版本要求对库选择的影响